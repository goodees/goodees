<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_102) on Sun Dec 10 14:46:07 CET 2017 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>EventSourcedEntity (ese-core 1.0-SNAPSHOT API)</title>
<meta name="date" content="2017-12-10">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="EventSourcedEntity (ese-core 1.0-SNAPSHOT API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/EventSourcedEntity.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../io/github/goodees/ese/core/EventHeader.html" title="class in io.github.goodees.ese.core"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.EntityInvocationState.html" title="enum in io.github.goodees.ese.core"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?io/github/goodees/ese/core/EventSourcedEntity.html" target="_top">Frames</a></li>
<li><a href="EventSourcedEntity.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">io.github.goodees.ese.core</div>
<h2 title="Class EventSourcedEntity" class="title">Class EventSourcedEntity</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://download.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>io.github.goodees.ese.core.EventSourcedEntity</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><a href="../../../../../io/github/goodees/ese/core/async/AsyncEntity.html" title="class in io.github.goodees.ese.core.async">AsyncEntity</a>, <a href="../../../../../io/github/goodees/ese/core/sync/ProxiedSyncEntity.html" title="class in io.github.goodees.ese.core.sync">ProxiedSyncEntity</a>, <a href="../../../../../io/github/goodees/ese/core/sync/SyncEntity.html" title="class in io.github.goodees.ese.core.sync">SyncEntity</a></dd>
</dl>
<hr>
<br>
<pre>public abstract class <span class="typeNameLabel">EventSourcedEntity</span>
extends <a href="http://download.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></pre>
<div class="block">A single event sourced entity. The entity is bound to a <a href="../../../../../io/github/goodees/ese/core/EventSourcingRuntimeBase.html" title="class in io.github.goodees.ese.core">runtime</a>, that will
 instantiate it, and a contract exists between the runtime and entity class to execute a <a href="../../../../../io/github/goodees/ese/core/Request.html" title="interface in io.github.goodees.ese.core"><code>Request</code></a>.
 <p>An entity is identified with unique String id. Usually the best in synthetic one (e. g. random uuid), but one take
 the risk, that business key might change, then it also can be a business key (e. g. charge box name, ip address).

 <p>An entity preserves its internal state. This state can <strong>only</strong> change as result of reception of an
 event in method <a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.html#updateState-io.github.goodees.ese.core.Event-"><code>updateState(Event)</code></a> (with exception of restoring a snapshot). The state of the entity,
 and the system in general <strong>may not</strong> change in other methods, especially not in methods that execute
 the request.

 <p>Any events that happen as consequence of executing event must be stored into provided <a href="../../../../../io/github/goodees/ese/core/store/EventStore.html" title="interface in io.github.goodees.ese.core.store"><code>EventStore</code></a>. This
 class does not define any specific method for that, it is left to subclasses to define API that is consistent with
 execution style of the entities.</p></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../io/github/goodees/ese/core/async/AsyncEntity.html" title="class in io.github.goodees.ese.core.async"><code>AsyncEntity</code></a>, 
<a href="../../../../../io/github/goodees/ese/core/sync/SyncEntity.html" title="class in io.github.goodees.ese.core.sync"><code>SyncEntity</code></a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.EntityInvocationState.html" title="enum in io.github.goodees.ese.core">EventSourcedEntity.EntityInvocationState</a></span></code>
<div class="block">The state entity is in.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.InvocationState.html" title="class in io.github.goodees.ese.core">EventSourcedEntity.InvocationState</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier</th>
<th class="colLast" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected </code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.html#EventSourcedEntity-java.lang.String-">EventSourcedEntity</a></span>(<a href="http://download.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;identity)</code>
<div class="block">Constructor for subclasses.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>protected <a href="http://download.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.html#createSnapshot--">createSnapshot</a></span>()</code>
<div class="block">Return (JSON) Serializable state of this entity.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>protected int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.html#getEventsSinceSnapshot--">getEventsSinceSnapshot</a></span>()</code>
<div class="block">Events applied since snapshot recovery.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="http://download.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.html#getIdentity--">getIdentity</a></span>()</code>
<div class="block">Return entity's identity.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>protected <a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.InvocationState.html" title="class in io.github.goodees.ese.core">EventSourcedEntity.InvocationState</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.html#getInvocationState--">getInvocationState</a></span>()</code>
<div class="block">Entity's state within invocation lifecycle.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.html#getStateVersion--">getStateVersion</a></span>()</code>
<div class="block">Version of an entity.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.html#handlePersistence-java.util.Collection-java.lang.Throwable-">handlePersistence</a></span>(<a href="http://download.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;? extends <a href="../../../../../io/github/goodees/ese/core/Event.html" title="interface in io.github.goodees.ese.core">Event</a>&gt;&nbsp;events,
                 <a href="http://download.oracle.com/javase/7/docs/api/java/lang/Throwable.html?is-external=true" title="class or interface in java.lang">Throwable</a>&nbsp;eventStoreError)</code>
<div class="block">Update state after events are persisted.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.html#handlePersistence-io.github.goodees.ese.core.Event-java.lang.Throwable-">handlePersistence</a></span>(<a href="../../../../../io/github/goodees/ese/core/Event.html" title="interface in io.github.goodees.ese.core">Event</a>&nbsp;event,
                 <a href="http://download.oracle.com/javase/7/docs/api/java/lang/Throwable.html?is-external=true" title="class or interface in java.lang">Throwable</a>&nbsp;eventStoreError)</code>
<div class="block">Update state after events are persisted.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.html#handlePersistenceFailure-java.lang.Throwable-">handlePersistenceFailure</a></span>(<a href="http://download.oracle.com/javase/7/docs/api/java/lang/Throwable.html?is-external=true" title="class or interface in java.lang">Throwable</a>&nbsp;eventStoreError)</code>&nbsp;</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.html#initialize--">initialize</a></span>()</code>
<div class="block">Callback called after entity is recovered from store.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>protected long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.html#nextEventVersion--">nextEventVersion</a></span>()</code>
<div class="block">Offer next version for an event.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.html#performPostInvocationActions-java.util.List-java.lang.Throwable-">performPostInvocationActions</a></span>(<a href="http://download.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../io/github/goodees/ese/core/Event.html" title="interface in io.github.goodees.ese.core">Event</a>&gt;&nbsp;events,
                            <a href="http://download.oracle.com/javase/7/docs/api/java/lang/Throwable.html?is-external=true" title="class or interface in java.lang">Throwable</a>&nbsp;thrownException)</code>
<div class="block">A callback called after execution of request finishes.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.html#restoreFromSnapshot-java.lang.Object-">restoreFromSnapshot</a></span>(<a href="http://download.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&nbsp;snapshot)</code>
<div class="block">Initialize the state from stored snapshot.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>protected abstract void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.html#updateState-io.github.goodees.ese.core.Event-">updateState</a></span>(<a href="../../../../../io/github/goodees/ese/core/Event.html" title="interface in io.github.goodees.ese.core">Event</a>&nbsp;event)</code>
<div class="block">Update the state as result of application of persisted event.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://download.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://download.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="http://download.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="http://download.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="http://download.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="http://download.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="http://download.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="http://download.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="http://download.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="http://download.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="http://download.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="http://download.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="EventSourcedEntity-java.lang.String-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>EventSourcedEntity</h4>
<pre>protected&nbsp;EventSourcedEntity(<a href="http://download.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;identity)</pre>
<div class="block">Constructor for subclasses. Both parameters are essential for the entity, as it needs to know what is it called,
 and where to store its events</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>identity</code> - the identity of the entity</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getIdentity--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getIdentity</h4>
<pre>public final&nbsp;<a href="http://download.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;getIdentity()</pre>
<div class="block">Return entity's identity.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>entity's identity</dd>
</dl>
</li>
</ul>
<a name="getStateVersion--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getStateVersion</h4>
<pre>public final&nbsp;long&nbsp;getStateVersion()</pre>
<div class="block">Version of an entity. Each entity has monotonic growing version number that corresponds to number of events it
 produced.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>current entity version</dd>
</dl>
</li>
</ul>
<a name="handlePersistence-io.github.goodees.ese.core.Event-java.lang.Throwable-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handlePersistence</h4>
<pre>protected final&nbsp;void&nbsp;handlePersistence(<a href="../../../../../io/github/goodees/ese/core/Event.html" title="interface in io.github.goodees.ese.core">Event</a>&nbsp;event,
                                       <a href="http://download.oracle.com/javase/7/docs/api/java/lang/Throwable.html?is-external=true" title="class or interface in java.lang">Throwable</a>&nbsp;eventStoreError)</pre>
<div class="block">Update state after events are persisted. Entity implementations should call this method to have
 their state updated via <a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.html#updateState-io.github.goodees.ese.core.Event-"><code>updateState(Event)</code></a> after events were persisted, as well as internal
 bookeeping of the entity to be updated. When storing events fail, this method should also be called to
 invalidate the entity.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>event</code> - event that was stored</dd>
<dd><code>eventStoreError</code> - error that happened during persistence of event</dd>
</dl>
</li>
</ul>
<a name="handlePersistence-java.util.Collection-java.lang.Throwable-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handlePersistence</h4>
<pre>protected final&nbsp;void&nbsp;handlePersistence(<a href="http://download.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;? extends <a href="../../../../../io/github/goodees/ese/core/Event.html" title="interface in io.github.goodees.ese.core">Event</a>&gt;&nbsp;events,
                                       <a href="http://download.oracle.com/javase/7/docs/api/java/lang/Throwable.html?is-external=true" title="class or interface in java.lang">Throwable</a>&nbsp;eventStoreError)</pre>
<div class="block">Update state after events are persisted. Entity implementations should call this method to have
 their state updated via <a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.html#updateState-io.github.goodees.ese.core.Event-"><code>updateState(Event)</code></a> after events were persisted, as well as internal
 bookeeping of the entity to be updated. When storing events fail, this method should also be called to
 invalidate the entity.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>events</code> - events that were stored</dd>
<dd><code>eventStoreError</code> - error that happened during persistence of event</dd>
</dl>
</li>
</ul>
<a name="handlePersistenceFailure-java.lang.Throwable-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handlePersistenceFailure</h4>
<pre>protected final&nbsp;void&nbsp;handlePersistenceFailure(<a href="http://download.oracle.com/javase/7/docs/api/java/lang/Throwable.html?is-external=true" title="class or interface in java.lang">Throwable</a>&nbsp;eventStoreError)</pre>
</li>
</ul>
<a name="updateState-io.github.goodees.ese.core.Event-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateState</h4>
<pre>protected abstract&nbsp;void&nbsp;updateState(<a href="../../../../../io/github/goodees/ese/core/Event.html" title="interface in io.github.goodees.ese.core">Event</a>&nbsp;event)</pre>
<div class="block">Update the state as result of application of persisted event. This method must be very robust - it may not throw
 an exception or break state invariants under any input. Failing to do so will make the entity irrecoverable and
 the system will not be able to use it.

 <p>On rare occasions, the state might need to be handled in different way when past events are replayed during
 recovery than when they are applied during request execution. In such case the method can query the current state
 in <a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.html#getInvocationState--"><code>getInvocationState()</code></a></p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>event</code> - event to apply</dd>
</dl>
</li>
</ul>
<a name="createSnapshot--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createSnapshot</h4>
<pre>protected&nbsp;<a href="http://download.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&nbsp;createSnapshot()</pre>
<div class="block">Return (JSON) Serializable state of this entity. This method will be called by the runtime to store the snapshot
 of the state in the database.
 <p>No specific serialization is prescribed, the contract for that is between the implementation of entity, its
 runtime, and the SnapshotStore that runtime uses to store the snapshot.</p></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a snapshot in a payload the runtime can store in the database, null if snapshotting is not supported</dd>
</dl>
</li>
</ul>
<a name="restoreFromSnapshot-java.lang.Object-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>restoreFromSnapshot</h4>
<pre>protected&nbsp;boolean&nbsp;restoreFromSnapshot(<a href="http://download.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&nbsp;snapshot)</pre>
<div class="block">Initialize the state from stored snapshot. Since during the lifetime of the projects the state representation
 changes, the entity may be required to support different versions of snapshots. That's why there is no restriction
 on the type of the object passed to it. The state may also significantly change, or might need to capture other aspects of past events.
 <p>If any of those conditions are true, the method should return <code>false</code>, and entity will get all of the
 historical events passed to method <a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.html#updateState-io.github.goodees.ese.core.Event-"><code>updateState(Event)</code></a></p>
 <p>If the method returns true, all events that happened past the snapshot will be replayed</p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>snapshot</code> - deserialized snapshot</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if state was restored from snapshot. Otherwise return false and the entire journal will be replayed</dd>
</dl>
</li>
</ul>
<a name="getEventsSinceSnapshot--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getEventsSinceSnapshot</h4>
<pre>protected final&nbsp;int&nbsp;getEventsSinceSnapshot()</pre>
<div class="block">Events applied since snapshot recovery. Can serve as information for the runtime on whether to make a new snapshot.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>events since last snapshot was stored</dd>
</dl>
</li>
</ul>
<a name="getInvocationState--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getInvocationState</h4>
<pre>protected final&nbsp;<a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.InvocationState.html" title="class in io.github.goodees.ese.core">EventSourcedEntity.InvocationState</a>&nbsp;getInvocationState()</pre>
<div class="block">Entity's state within invocation lifecycle. Runtime uses this information to assert consistency of processing,
 entity may use it to determine details about events resulting from an invocation, or whether the recovery is
 underway</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>entity's invocation state.</dd>
</dl>
</li>
</ul>
<a name="performPostInvocationActions-java.util.List-java.lang.Throwable-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>performPostInvocationActions</h4>
<pre>protected&nbsp;void&nbsp;performPostInvocationActions(<a href="http://download.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../io/github/goodees/ese/core/Event.html" title="interface in io.github.goodees.ese.core">Event</a>&gt;&nbsp;events,
                                            <a href="http://download.oracle.com/javase/7/docs/api/java/lang/Throwable.html?is-external=true" title="class or interface in java.lang">Throwable</a>&nbsp;thrownException)</pre>
<div class="block">A callback called after execution of request finishes. May be used to plug request-independent side effects that
 can act of events generated during single execution run.
 <p>This method must not change state or try to persistAndUpdate events.</p>
 <p>Rather than called for each individual event (which is the most common scenario), all events are passed.
 This is to allow suppress side effects if some compensation event is persisted after an event that would trigger
 a side effect.</p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>events</code> - Events persisted during currently finished invocation</dd>
<dd><code>thrownException</code> - Thrown exception in case the processing did not complete successfully</dd>
</dl>
</li>
</ul>
<a name="initialize--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initialize</h4>
<pre>protected&nbsp;void&nbsp;initialize()</pre>
<div class="block">Callback called after entity is recovered from store. It is called before request is executed when the instance
 was created anew, or if snapshot store has some more events.</div>
</li>
</ul>
<a name="nextEventVersion--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>nextEventVersion</h4>
<pre>protected final&nbsp;long&nbsp;nextEventVersion()</pre>
<div class="block">Offer next version for an event.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the version next produced event should have</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/EventSourcedEntity.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../io/github/goodees/ese/core/EventHeader.html" title="class in io.github.goodees.ese.core"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../io/github/goodees/ese/core/EventSourcedEntity.EntityInvocationState.html" title="enum in io.github.goodees.ese.core"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?io/github/goodees/ese/core/EventSourcedEntity.html" target="_top">Frames</a></li>
<li><a href="EventSourcedEntity.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2017 <a href="https://pdudits.github.io">Patrik Duditš</a>. All Rights Reserved.</small></p>
</body>
</html>
